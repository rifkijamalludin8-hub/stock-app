<%- include('../partials/auth-head', { pageTitle: 'Pilih Perusahaan' }) %>

<h1 class="auth-title">Pilih Perusahaan</h1>
<p class="auth-sub">Satu aplikasi untuk banyak perusahaan. Pilih perusahaan atau buat yang baru.</p>

<div class="company-grid">
  <% if (companies.length === 0) { %>
    <div class="empty-state">Belum ada perusahaan. Silakan buat perusahaan pertama.</div>
  <% } %>
  <% companies.forEach((company) => { %>
    <div class="company-card">
      <div>
        <div class="company-card-name"><%= company.name %></div>
        <div class="company-card-sub">DB: <%= company.db_path %></div>
      </div>
      <a class="btn primary" href="/login?company=<%= company.id %>">Masuk</a>
    </div>
  <% }) %>
</div>

<div class="auth-section">
  <h2>Buat Perusahaan Baru</h2>
  <form method="post" action="/companies" class="form-grid">
    <input type="hidden" name="mode" value="create" />
    <label>
      Nama Perusahaan
      <input name="name" placeholder="PT Maju Jaya" required />
    </label>
    <label>
      Slug (opsional)
      <input name="slug" placeholder="pt-maju-jaya" />
    </label>
    <label>
      Nama User Utama
      <input name="user_name" placeholder="Owner" />
    </label>
    <label>
      Email User Utama
      <input name="email" type="email" placeholder="owner@email.com" required />
    </label>
    <label>
      Password
      <input name="password" type="password" required />
    </label>
    <label>
      Role User Utama
      <select name="role">
        <option value="user">User (lihat harga)</option>
        <option value="admin">Admin (tanpa harga)</option>
      </select>
    </label>
    <% if (requireSetupKey) { %>
      <label>
        Setup Key
        <input name="setup_key" type="password" required />
      </label>
    <% } %>
    <button class="btn primary" type="submit">Buat Perusahaan</button>
  </form>
</div>

<div class="auth-section">
  <h2>Koneksikan Database Existing</h2>
  <form method="post" action="/companies" class="form-grid">
    <input type="hidden" name="mode" value="connect" />
    <label>
      Nama Perusahaan
      <input name="name" placeholder="PT Lama" required />
    </label>
    <label>
      Path Database (.db)
      <input name="db_path" placeholder="/path/to/company.db" required />
    </label>
    <% if (requireSetupKey) { %>
      <label>
        Setup Key
        <input name="setup_key" type="password" required />
      </label>
    <% } %>
    <button class="btn ghost" type="submit">Hubungkan</button>
  </form>
</div>

<%- include('../partials/auth-foot') %>
